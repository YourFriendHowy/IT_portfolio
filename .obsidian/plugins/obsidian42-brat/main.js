"use strict";var Ut=Object.create;var re=Object.defineProperty;var Vt=Object.getOwnPropertyDescriptor;var _t=Object.getOwnPropertyNames;var Ht=Object.getPrototypeOf,Gt=Object.prototype.hasOwnProperty;var S=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports),jt=(s,e)=>{for(var i in e)re(s,i,{get:e[i],enumerable:!0})},Ve=(s,e,i,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of _t(e))!Gt.call(s,n)&&n!==i&&re(s,n,{get:()=>e[n],enumerable:!(t=Vt(e,n))||t.enumerable});return s};var zt=(s,e,i)=>(i=s!=null?Ut(Ht(s)):{},Ve(e||!s||!s.__esModule?re(i,"default",{value:s,enumerable:!0}):i,s)),qt=s=>Ve(re({},"__esModule",{value:!0}),s);var ye=S((qi,_e)=>{var Yt=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...s)=>console.error("SEMVER",...s):()=>{};_e.exports=Yt});var Te=S((Yi,He)=>{var Xt="2.0.0",Wt=Number.MAX_SAFE_INTEGER||9007199254740991,Jt=16,Qt=250,Zt=["major","premajor","minor","preminor","patch","prepatch","prerelease"];He.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:Jt,MAX_SAFE_BUILD_LENGTH:Qt,MAX_SAFE_INTEGER:Wt,RELEASE_TYPES:Zt,SEMVER_SPEC_VERSION:Xt,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var Re=S((C,Ge)=>{var{MAX_SAFE_COMPONENT_LENGTH:Pe,MAX_SAFE_BUILD_LENGTH:Kt,MAX_LENGTH:ei}=Te(),ti=ye();C=Ge.exports={};var ii=C.re=[],ni=C.safeRe=[],g=C.src=[],si=C.safeSrc=[],c=C.t={},oi=0,ve="[a-zA-Z0-9-]",ri=[["\\s",1],["\\d",ei],[ve,Kt]],ai=s=>{for(let[e,i]of ri)s=s.split(`${e}*`).join(`${e}{0,${i}}`).split(`${e}+`).join(`${e}{1,${i}}`);return s},p=(s,e,i)=>{let t=ai(e),n=oi++;ti(s,n,e),c[s]=n,g[n]=e,si[n]=t,ii[n]=new RegExp(e,i?"g":void 0),ni[n]=new RegExp(t,i?"g":void 0)};p("NUMERICIDENTIFIER","0|[1-9]\\d*");p("NUMERICIDENTIFIERLOOSE","\\d+");p("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${ve}*`);p("MAINVERSION",`(${g[c.NUMERICIDENTIFIER]})\\.(${g[c.NUMERICIDENTIFIER]})\\.(${g[c.NUMERICIDENTIFIER]})`);p("MAINVERSIONLOOSE",`(${g[c.NUMERICIDENTIFIERLOOSE]})\\.(${g[c.NUMERICIDENTIFIERLOOSE]})\\.(${g[c.NUMERICIDENTIFIERLOOSE]})`);p("PRERELEASEIDENTIFIER",`(?:${g[c.NUMERICIDENTIFIER]}|${g[c.NONNUMERICIDENTIFIER]})`);p("PRERELEASEIDENTIFIERLOOSE",`(?:${g[c.NUMERICIDENTIFIERLOOSE]}|${g[c.NONNUMERICIDENTIFIER]})`);p("PRERELEASE",`(?:-(${g[c.PRERELEASEIDENTIFIER]}(?:\\.${g[c.PRERELEASEIDENTIFIER]})*))`);p("PRERELEASELOOSE",`(?:-?(${g[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${g[c.PRERELEASEIDENTIFIERLOOSE]})*))`);p("BUILDIDENTIFIER",`${ve}+`);p("BUILD",`(?:\\+(${g[c.BUILDIDENTIFIER]}(?:\\.${g[c.BUILDIDENTIFIER]})*))`);p("FULLPLAIN",`v?${g[c.MAINVERSION]}${g[c.PRERELEASE]}?${g[c.BUILD]}?`);p("FULL",`^${g[c.FULLPLAIN]}$`);p("LOOSEPLAIN",`[v=\\s]*${g[c.MAINVERSIONLOOSE]}${g[c.PRERELEASELOOSE]}?${g[c.BUILD]}?`);p("LOOSE",`^${g[c.LOOSEPLAIN]}$`);p("GTLT","((?:<|>)?=?)");p("XRANGEIDENTIFIERLOOSE",`${g[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);p("XRANGEIDENTIFIER",`${g[c.NUMERICIDENTIFIER]}|x|X|\\*`);p("XRANGEPLAIN",`[v=\\s]*(${g[c.XRANGEIDENTIFIER]})(?:\\.(${g[c.XRANGEIDENTIFIER]})(?:\\.(${g[c.XRANGEIDENTIFIER]})(?:${g[c.PRERELEASE]})?${g[c.BUILD]}?)?)?`);p("XRANGEPLAINLOOSE",`[v=\\s]*(${g[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${g[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${g[c.XRANGEIDENTIFIERLOOSE]})(?:${g[c.PRERELEASELOOSE]})?${g[c.BUILD]}?)?)?`);p("XRANGE",`^${g[c.GTLT]}\\s*${g[c.XRANGEPLAIN]}$`);p("XRANGELOOSE",`^${g[c.GTLT]}\\s*${g[c.XRANGEPLAINLOOSE]}$`);p("COERCEPLAIN",`(^|[^\\d])(\\d{1,${Pe}})(?:\\.(\\d{1,${Pe}}))?(?:\\.(\\d{1,${Pe}}))?`);p("COERCE",`${g[c.COERCEPLAIN]}(?:$|[^\\d])`);p("COERCEFULL",g[c.COERCEPLAIN]+`(?:${g[c.PRERELEASE]})?(?:${g[c.BUILD]})?(?:$|[^\\d])`);p("COERCERTL",g[c.COERCE],!0);p("COERCERTLFULL",g[c.COERCEFULL],!0);p("LONETILDE","(?:~>?)");p("TILDETRIM",`(\\s*)${g[c.LONETILDE]}\\s+`,!0);C.tildeTrimReplace="$1~";p("TILDE",`^${g[c.LONETILDE]}${g[c.XRANGEPLAIN]}$`);p("TILDELOOSE",`^${g[c.LONETILDE]}${g[c.XRANGEPLAINLOOSE]}$`);p("LONECARET","(?:\\^)");p("CARETTRIM",`(\\s*)${g[c.LONECARET]}\\s+`,!0);C.caretTrimReplace="$1^";p("CARET",`^${g[c.LONECARET]}${g[c.XRANGEPLAIN]}$`);p("CARETLOOSE",`^${g[c.LONECARET]}${g[c.XRANGEPLAINLOOSE]}$`);p("COMPARATORLOOSE",`^${g[c.GTLT]}\\s*(${g[c.LOOSEPLAIN]})$|^$`);p("COMPARATOR",`^${g[c.GTLT]}\\s*(${g[c.FULLPLAIN]})$|^$`);p("COMPARATORTRIM",`(\\s*)${g[c.GTLT]}\\s*(${g[c.LOOSEPLAIN]}|${g[c.XRANGEPLAIN]})`,!0);C.comparatorTrimReplace="$1$2$3";p("HYPHENRANGE",`^\\s*(${g[c.XRANGEPLAIN]})\\s+-\\s+(${g[c.XRANGEPLAIN]})\\s*$`);p("HYPHENRANGELOOSE",`^\\s*(${g[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${g[c.XRANGEPLAINLOOSE]})\\s*$`);p("STAR","(<|>)?=?\\s*\\*");p("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");p("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var ze=S((Xi,je)=>{var li=Object.freeze({loose:!0}),ui=Object.freeze({}),gi=s=>s?typeof s!="object"?li:s:ui;je.exports=gi});var We=S((Wi,Xe)=>{var qe=/^[0-9]+$/,Ye=(s,e)=>{let i=qe.test(s),t=qe.test(e);return i&&t&&(s=+s,e=+e),s===e?0:i&&!t?-1:t&&!i?1:s<e?-1:1},ci=(s,e)=>Ye(e,s);Xe.exports={compareIdentifiers:Ye,rcompareIdentifiers:ci}});var ge=S((Ji,Ke)=>{var ae=ye(),{MAX_LENGTH:Je,MAX_SAFE_INTEGER:le}=Te(),{safeRe:Qe,safeSrc:Ze,t:ue}=Re(),di=ze(),{compareIdentifiers:B}=We(),Ne=class s{constructor(e,i){if(i=di(i),e instanceof s){if(e.loose===!!i.loose&&e.includePrerelease===!!i.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>Je)throw new TypeError(`version is longer than ${Je} characters`);ae("SemVer",e,i),this.options=i,this.loose=!!i.loose,this.includePrerelease=!!i.includePrerelease;let t=e.trim().match(i.loose?Qe[ue.LOOSE]:Qe[ue.FULL]);if(!t)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+t[1],this.minor=+t[2],this.patch=+t[3],this.major>le||this.major<0)throw new TypeError("Invalid major version");if(this.minor>le||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>le||this.patch<0)throw new TypeError("Invalid patch version");t[4]?this.prerelease=t[4].split(".").map(n=>{if(/^[0-9]+$/.test(n)){let o=+n;if(o>=0&&o<le)return o}return n}):this.prerelease=[],this.build=t[5]?t[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(ae("SemVer.compare",this.version,this.options,e),!(e instanceof s)){if(typeof e=="string"&&e===this.version)return 0;e=new s(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof s||(e=new s(e,this.options)),B(this.major,e.major)||B(this.minor,e.minor)||B(this.patch,e.patch)}comparePre(e){if(e instanceof s||(e=new s(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let i=0;do{let t=this.prerelease[i],n=e.prerelease[i];if(ae("prerelease compare",i,t,n),t===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(t===void 0)return-1;if(t===n)continue;return B(t,n)}while(++i)}compareBuild(e){e instanceof s||(e=new s(e,this.options));let i=0;do{let t=this.build[i],n=e.build[i];if(ae("build compare",i,t,n),t===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(t===void 0)return-1;if(t===n)continue;return B(t,n)}while(++i)}inc(e,i,t){if(e.startsWith("pre")){if(!i&&t===!1)throw new Error("invalid increment argument: identifier is empty");if(i){let n=new RegExp(`^${this.options.loose?Ze[ue.PRERELEASELOOSE]:Ze[ue.PRERELEASE]}$`),o=`-${i}`.match(n);if(!o||o[1]!==i)throw new Error(`invalid identifier: ${i}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",i,t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",i,t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",i,t),this.inc("pre",i,t);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",i,t),this.inc("pre",i,t);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let n=Number(t)?1:0;if(this.prerelease.length===0)this.prerelease=[n];else{let o=this.prerelease.length;for(;--o>=0;)typeof this.prerelease[o]=="number"&&(this.prerelease[o]++,o=-2);if(o===-1){if(i===this.prerelease.join(".")&&t===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(n)}}if(i){let o=[i,n];t===!1&&(o=[i]),B(this.prerelease[0],i)===0?isNaN(this.prerelease[1])&&(this.prerelease=o):this.prerelease=o}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};Ke.exports=Ne});var Ie=S((Qi,tt)=>{var et=ge(),pi=(s,e,i)=>new et(s,i).compare(new et(e,i));tt.exports=pi});var st=S((Zi,nt)=>{var it=ge(),mi=(s,e,i=!1)=>{if(s instanceof it)return s;try{return new it(s,e)}catch(t){if(!i)return null;throw t}};nt.exports=mi});var Le=S((Ki,ot)=>{var hi=ge(),fi=st(),{safeRe:ce,t:de}=Re(),bi=(s,e)=>{if(s instanceof hi)return s;if(typeof s=="number"&&(s=String(s)),typeof s!="string")return null;e=e||{};let i=null;if(!e.rtl)i=s.match(e.includePrerelease?ce[de.COERCEFULL]:ce[de.COERCE]);else{let l=e.includePrerelease?ce[de.COERCERTLFULL]:ce[de.COERCERTL],u;for(;(u=l.exec(s))&&(!i||i.index+i[0].length!==s.length);)(!i||u.index+u[0].length!==i.index+i[0].length)&&(i=u),l.lastIndex=u.index+u[1].length+u[2].length;l.lastIndex=-1}if(i===null)return null;let t=i[2],n=i[3]||"0",o=i[4]||"0",r=e.includePrerelease&&i[5]?`-${i[5]}`:"",a=e.includePrerelease&&i[6]?`+${i[6]}`:"";return fi(`${t}.${n}.${o}${r}${a}`,e)};ot.exports=bi});var kt=S(h=>{"use strict";Object.defineProperty(h,"__esModule",{value:!0});var T=require("obsidian"),Fe="YYYY-MM-DD",Oe="gggg-[W]ww",Pt="YYYY-MM",vt="YYYY-[Q]Q",Rt="YYYY";function Z(s){var i,t;let e=window.app.plugins.getPlugin("periodic-notes");return e&&((t=(i=e.settings)==null?void 0:i[s])==null?void 0:t.enabled)}function K(){var s,e,i,t;try{let{internalPlugins:n,plugins:o}=window.app;if(Z("daily")){let{format:u,folder:d,template:f}=((e=(s=o.getPlugin("periodic-notes"))==null?void 0:s.settings)==null?void 0:e.daily)||{};return{format:u||Fe,folder:(d==null?void 0:d.trim())||"",template:(f==null?void 0:f.trim())||""}}let{folder:r,format:a,template:l}=((t=(i=n.getPluginById("daily-notes"))==null?void 0:i.instance)==null?void 0:t.options)||{};return{format:a||Fe,folder:(r==null?void 0:r.trim())||"",template:(l==null?void 0:l.trim())||""}}catch(n){console.info("No custom daily note settings found!",n)}}function ee(){var s,e,i,t,n,o,r;try{let a=window.app.plugins,l=(s=a.getPlugin("calendar"))==null?void 0:s.options,u=(i=(e=a.getPlugin("periodic-notes"))==null?void 0:e.settings)==null?void 0:i.weekly;if(Z("weekly"))return{format:u.format||Oe,folder:((t=u.folder)==null?void 0:t.trim())||"",template:((n=u.template)==null?void 0:n.trim())||""};let d=l||{};return{format:d.weeklyNoteFormat||Oe,folder:((o=d.weeklyNoteFolder)==null?void 0:o.trim())||"",template:((r=d.weeklyNoteTemplate)==null?void 0:r.trim())||""}}catch(a){console.info("No custom weekly note settings found!",a)}}function te(){var e,i,t,n;let s=window.app.plugins;try{let o=Z("monthly")&&((i=(e=s.getPlugin("periodic-notes"))==null?void 0:e.settings)==null?void 0:i.monthly)||{};return{format:o.format||Pt,folder:((t=o.folder)==null?void 0:t.trim())||"",template:((n=o.template)==null?void 0:n.trim())||""}}catch(o){console.info("No custom monthly note settings found!",o)}}function ie(){var e,i,t,n;let s=window.app.plugins;try{let o=Z("quarterly")&&((i=(e=s.getPlugin("periodic-notes"))==null?void 0:e.settings)==null?void 0:i.quarterly)||{};return{format:o.format||vt,folder:((t=o.folder)==null?void 0:t.trim())||"",template:((n=o.template)==null?void 0:n.trim())||""}}catch(o){console.info("No custom quarterly note settings found!",o)}}function ne(){var e,i,t,n;let s=window.app.plugins;try{let o=Z("yearly")&&((i=(e=s.getPlugin("periodic-notes"))==null?void 0:e.settings)==null?void 0:i.yearly)||{};return{format:o.format||Rt,folder:((t=o.folder)==null?void 0:t.trim())||"",template:((n=o.template)==null?void 0:n.trim())||""}}catch(o){console.info("No custom yearly note settings found!",o)}}function Nt(...s){let e=[];for(let t=0,n=s.length;t<n;t++)e=e.concat(s[t].split("/"));let i=[];for(let t=0,n=e.length;t<n;t++){let o=e[t];!o||o==="."||i.push(o)}return e[0]===""&&i.unshift(""),i.join("/")}function Pi(s){let e=s.substring(s.lastIndexOf("/")+1);return e.lastIndexOf(".")!=-1&&(e=e.substring(0,e.lastIndexOf("."))),e}async function vi(s){let e=s.replace(/\\/g,"/").split("/");if(e.pop(),e.length){let i=Nt(...e);window.app.vault.getAbstractFileByPath(i)||await window.app.vault.createFolder(i)}}async function se(s,e){e.endsWith(".md")||(e+=".md");let i=T.normalizePath(Nt(s,e));return await vi(i),i}async function H(s){let{metadataCache:e,vault:i}=window.app,t=T.normalizePath(s);if(t==="/")return Promise.resolve(["",null]);try{let n=e.getFirstLinkpathDest(t,""),o=await i.cachedRead(n),r=window.app.foldManager.load(n);return[o,r]}catch(n){return console.error(`Failed to read the daily note template '${t}'`,n),new T.Notice("Failed to read the daily note template"),["",null]}}function L(s,e="day"){let i=s.clone().startOf(e).format();return`${e}-${i}`}function It(s){return s.replace(/\[[^\]]*\]/g,"")}function Ri(s,e){if(e==="week"){let i=It(s);return/w{1,2}/i.test(i)&&(/M{1,4}/.test(i)||/D{1,4}/.test(i))}return!1}function G(s,e){return Lt(s.basename,e)}function Ni(s,e){return Lt(Pi(s),e)}function Lt(s,e){let t={day:K,week:ee,month:te,quarter:ie,year:ne}[e]().format.split("/").pop(),n=window.moment(s,t,!0);if(!n.isValid())return null;if(Ri(t,e)&&e==="week"){let o=It(t);if(/w{1,2}/i.test(o))return window.moment(s,t.replace(/M{1,4}/g,"").replace(/D{1,4}/g,""),!1)}return n}var De=class extends Error{};async function At(s){let e=window.app,{vault:i}=e,t=window.moment,{template:n,format:o,folder:r}=K(),[a,l]=await H(n),u=s.format(o),d=await se(r,u);try{let f=await i.create(d,a.replace(/{{\s*date\s*}}/gi,u).replace(/{{\s*time\s*}}/gi,t().format("HH:mm")).replace(/{{\s*title\s*}}/gi,u).replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(w,b,E,y,v,P)=>{let A=t(),x=s.clone().set({hour:A.get("hour"),minute:A.get("minute"),second:A.get("second")});return E&&x.add(parseInt(y,10),v),P?x.format(P.substring(1).trim()):x.format(o)}).replace(/{{\s*yesterday\s*}}/gi,s.clone().subtract(1,"day").format(o)).replace(/{{\s*tomorrow\s*}}/gi,s.clone().add(1,"d").format(o)));return e.foldManager.save(f,l),f}catch(f){console.error(`Failed to create file: '${d}'`,f),new T.Notice("Unable to create new file.")}}function Ii(s,e){var i;return(i=e[L(s,"day")])!=null?i:null}function Li(){let{vault:s}=window.app,{folder:e}=K(),i=s.getAbstractFileByPath(T.normalizePath(e));if(!i)throw new De("Failed to find daily notes folder");let t={};return T.Vault.recurseChildren(i,n=>{if(n instanceof T.TFile){let o=G(n,"day");if(o){let r=L(o,"day");t[r]=n}}}),t}var ke=class extends Error{};function Ai(){let{moment:s}=window,e=s.localeData()._week.dow,i=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];for(;e;)i.push(i.shift()),e--;return i}function Si(s){return Ai().indexOf(s.toLowerCase())}async function St(s){let{vault:e}=window.app,{template:i,format:t,folder:n}=ee(),[o,r]=await H(i),a=s.format(t),l=await se(n,a);try{let u=await e.create(l,o.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(d,f,w,b,E,y)=>{let v=window.moment(),P=s.clone().set({hour:v.get("hour"),minute:v.get("minute"),second:v.get("second")});return w&&P.add(parseInt(b,10),E),y?P.format(y.substring(1).trim()):P.format(t)}).replace(/{{\s*title\s*}}/gi,a).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*(sunday|monday|tuesday|wednesday|thursday|friday|saturday)\s*:(.*?)}}/gi,(d,f,w)=>{let b=Si(f);return s.weekday(b).format(w.trim())}));return window.app.foldManager.save(u,r),u}catch(u){console.error(`Failed to create file: '${l}'`,u),new T.Notice("Unable to create new file.")}}function Ci(s,e){var i;return(i=e[L(s,"week")])!=null?i:null}function $i(){let s={};if(!$t())return s;let{vault:e}=window.app,{folder:i}=ee(),t=e.getAbstractFileByPath(T.normalizePath(i));if(!t)throw new ke("Failed to find weekly notes folder");return T.Vault.recurseChildren(t,n=>{if(n instanceof T.TFile){let o=G(n,"week");if(o){let r=L(o,"week");s[r]=n}}}),s}var Me=class extends Error{};async function Ct(s){let{vault:e}=window.app,{template:i,format:t,folder:n}=te(),[o,r]=await H(i),a=s.format(t),l=await se(n,a);try{let u=await e.create(l,o.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(d,f,w,b,E,y)=>{let v=window.moment(),P=s.clone().set({hour:v.get("hour"),minute:v.get("minute"),second:v.get("second")});return w&&P.add(parseInt(b,10),E),y?P.format(y.substring(1).trim()):P.format(t)}).replace(/{{\s*date\s*}}/gi,a).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,a));return window.app.foldManager.save(u,r),u}catch(u){console.error(`Failed to create file: '${l}'`,u),new T.Notice("Unable to create new file.")}}function Fi(s,e){var i;return(i=e[L(s,"month")])!=null?i:null}function Oi(){let s={};if(!Ft())return s;let{vault:e}=window.app,{folder:i}=te(),t=e.getAbstractFileByPath(T.normalizePath(i));if(!t)throw new Me("Failed to find monthly notes folder");return T.Vault.recurseChildren(t,n=>{if(n instanceof T.TFile){let o=G(n,"month");if(o){let r=L(o,"month");s[r]=n}}}),s}var xe=class extends Error{};async function Di(s){let{vault:e}=window.app,{template:i,format:t,folder:n}=ie(),[o,r]=await H(i),a=s.format(t),l=await se(n,a);try{let u=await e.create(l,o.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(d,f,w,b,E,y)=>{let v=window.moment(),P=s.clone().set({hour:v.get("hour"),minute:v.get("minute"),second:v.get("second")});return w&&P.add(parseInt(b,10),E),y?P.format(y.substring(1).trim()):P.format(t)}).replace(/{{\s*date\s*}}/gi,a).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,a));return window.app.foldManager.save(u,r),u}catch(u){console.error(`Failed to create file: '${l}'`,u),new T.Notice("Unable to create new file.")}}function ki(s,e){var i;return(i=e[L(s,"quarter")])!=null?i:null}function Mi(){let s={};if(!Ot())return s;let{vault:e}=window.app,{folder:i}=ie(),t=e.getAbstractFileByPath(T.normalizePath(i));if(!t)throw new xe("Failed to find quarterly notes folder");return T.Vault.recurseChildren(t,n=>{if(n instanceof T.TFile){let o=G(n,"quarter");if(o){let r=L(o,"quarter");s[r]=n}}}),s}var Be=class extends Error{};async function xi(s){let{vault:e}=window.app,{template:i,format:t,folder:n}=ne(),[o,r]=await H(i),a=s.format(t),l=await se(n,a);try{let u=await e.create(l,o.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi,(d,f,w,b,E,y)=>{let v=window.moment(),P=s.clone().set({hour:v.get("hour"),minute:v.get("minute"),second:v.get("second")});return w&&P.add(parseInt(b,10),E),y?P.format(y.substring(1).trim()):P.format(t)}).replace(/{{\s*date\s*}}/gi,a).replace(/{{\s*time\s*}}/gi,window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi,a));return window.app.foldManager.save(u,r),u}catch(u){console.error(`Failed to create file: '${l}'`,u),new T.Notice("Unable to create new file.")}}function Bi(s,e){var i;return(i=e[L(s,"year")])!=null?i:null}function Ui(){let s={};if(!Dt())return s;let{vault:e}=window.app,{folder:i}=ne(),t=e.getAbstractFileByPath(T.normalizePath(i));if(!t)throw new Be("Failed to find yearly notes folder");return T.Vault.recurseChildren(t,n=>{if(n instanceof T.TFile){let o=G(n,"year");if(o){let r=L(o,"year");s[r]=n}}}),s}function Vi(){var t,n;let{app:s}=window,e=s.internalPlugins.plugins["daily-notes"];if(e&&e.enabled)return!0;let i=s.plugins.getPlugin("periodic-notes");return i&&((n=(t=i.settings)==null?void 0:t.daily)==null?void 0:n.enabled)}function $t(){var i,t;let{app:s}=window;if(s.plugins.getPlugin("calendar"))return!0;let e=s.plugins.getPlugin("periodic-notes");return e&&((t=(i=e.settings)==null?void 0:i.weekly)==null?void 0:t.enabled)}function Ft(){var i,t;let{app:s}=window,e=s.plugins.getPlugin("periodic-notes");return e&&((t=(i=e.settings)==null?void 0:i.monthly)==null?void 0:t.enabled)}function Ot(){var i,t;let{app:s}=window,e=s.plugins.getPlugin("periodic-notes");return e&&((t=(i=e.settings)==null?void 0:i.quarterly)==null?void 0:t.enabled)}function Dt(){var i,t;let{app:s}=window,e=s.plugins.getPlugin("periodic-notes");return e&&((t=(i=e.settings)==null?void 0:i.yearly)==null?void 0:t.enabled)}function _i(s){let e={day:K,week:ee,month:te,quarter:ie,year:ne}[s];return e()}function Hi(s,e){return{day:At,month:Ct,week:St}[s](e)}h.DEFAULT_DAILY_NOTE_FORMAT=Fe;h.DEFAULT_MONTHLY_NOTE_FORMAT=Pt;h.DEFAULT_QUARTERLY_NOTE_FORMAT=vt;h.DEFAULT_WEEKLY_NOTE_FORMAT=Oe;h.DEFAULT_YEARLY_NOTE_FORMAT=Rt;h.appHasDailyNotesPluginLoaded=Vi;h.appHasMonthlyNotesPluginLoaded=Ft;h.appHasQuarterlyNotesPluginLoaded=Ot;h.appHasWeeklyNotesPluginLoaded=$t;h.appHasYearlyNotesPluginLoaded=Dt;h.createDailyNote=At;h.createMonthlyNote=Ct;h.createPeriodicNote=Hi;h.createQuarterlyNote=Di;h.createWeeklyNote=St;h.createYearlyNote=xi;h.getAllDailyNotes=Li;h.getAllMonthlyNotes=Oi;h.getAllQuarterlyNotes=Mi;h.getAllWeeklyNotes=$i;h.getAllYearlyNotes=Ui;h.getDailyNote=Ii;h.getDailyNoteSettings=K;h.getDateFromFile=G;h.getDateFromPath=Ni;h.getDateUID=L;h.getMonthlyNote=Fi;h.getMonthlyNoteSettings=te;h.getPeriodicNoteSettings=_i;h.getQuarterlyNote=ki;h.getQuarterlyNoteSettings=ie;h.getTemplateInfo=H;h.getWeeklyNote=Ci;h.getWeeklyNoteSettings=ee;h.getYearlyNote=Bi;h.getYearlyNoteSettings=ne});var Gi={};jt(Gi,{default:()=>Ee});module.exports=qt(Gi);var Bt=require("obsidian");var F=require("obsidian");var N=class extends Error{constructor(i,t,n,o){let r=Math.ceil((n-Math.floor(Date.now()/1e3))/60);super(`GitHub API rate limit exceeded. Reset in ${r} minutes.`);this.limit=i;this.remaining=t;this.reset=n;this.requestUrl=o;this.name="GitHubRateLimitError"}getMinutesToReset(){return Math.ceil((this.reset-Math.floor(Date.now()/1e3))/60)}};var D=require("obsidian");var wi=Ie(),rt=Le(),Ae=async(s,e=!0,i="")=>{let t=`https://api.github.com/repos/${s}`;try{let n=await Ce({url:t,headers:i?{Authorization:`Token ${i}`}:{}});return(await JSON.parse(n)).private}catch(n){if(n instanceof N)throw n;return e&&console.log("error in isPrivateRepo",t,n),!1}},at=async(s,e=!0,i="")=>{let t=`https://api.github.com/repos/${s}/releases`;try{let n=await Ce({url:t,headers:i?{Authorization:`Token ${i}`}:{}});return(await JSON.parse(n)).map(r=>({version:r.tag_name,prerelease:r.prerelease}))}catch(n){if(n instanceof N)throw n;return e&&console.log("error in fetchReleaseVersions",t,n),null}},j=async(s,e,i=!0,t=!1,n="")=>{try{let o=s.assets.find(l=>l.name===e);if(!o)return null;let r={Accept:"application/octet-stream"};(t&&n||n)&&(r.Authorization=`Token ${n}`);let a=await(0,D.request)({url:o.url,headers:r});return a==="Not Found"||a==='{"error":"Not Found"}'?null:a}catch(o){if(o instanceof N)throw o;return i&&console.log("error in grabReleaseFileFromRepository",URL,o),null}},lt=async(s=!0)=>{let e="https://raw.githubusercontent.com/obsidianmd/obsidian-releases/HEAD/community-plugins.json";try{let i=await(0,D.request)({url:e});return i==="404: Not Found"?null:await JSON.parse(i)}catch(i){return s&&console.log("error in grabCommmunityPluginList",i),null}},ut=async(s=!0)=>{let e="https://raw.githubusercontent.com/obsidianmd/obsidian-releases/HEAD/community-css-themes.json";try{let i=await(0,D.request)({url:e});return i==="404: Not Found"?null:await JSON.parse(i)}catch(i){return s&&console.log("error in grabCommmunityThemesList",i),null}},U=async(s,e=!1,i=!1)=>{let t=`https://raw.githubusercontent.com/${s}/HEAD/theme${e?"-beta":""}.css`;try{let n=await(0,D.request)({url:t});return n==="404: Not Found"?null:n}catch(n){return i&&console.log("error in grabCommmunityThemeCssFile",n),null}},gt=async(s,e=!0)=>{let i=`https://raw.githubusercontent.com/${s}/HEAD/manifest.json`;try{let t=await(0,D.request)({url:i});return t==="404: Not Found"?null:t}catch(t){return e&&console.log("error in grabCommmunityThemeManifestFile",t),null}},Ei=s=>{let e=0;for(let i=0;i<s.length;i++)e+=s.charCodeAt(i);return e},z=s=>Ei(s).toString(),q=async(s,e,i)=>{let t=await U(s,e,i);return t?z(t):"0"},yi=async(s,e,i=!0)=>{let t=`https://api.github.com/repos/${s}/commits?path=${e}&page=1&per_page=1`;try{let n=await(0,D.request)({url:t});return n==="404: Not Found"?null:JSON.parse(n)}catch(n){return i&&console.log("error in grabLastCommitInfoForAFile",n),null}},ct=async(s,e)=>{var t;let i=await yi(s,e);return i&&i.length>0&&((t=i[0].commit.committer)!=null&&t.date)?i[0].commit.committer.date:""},Se=async(s,e,i=!1,t=!1,n=!1,o)=>{var r;try{let a=e&&e!=="latest"?`https://api.github.com/repos/${s}/releases/tags/${e}`:`https://api.github.com/repos/${s}/releases`,l={Accept:"application/vnd.github.v3+json"};(n&&o||o)&&(l.Authorization=`Token ${o}`);let u=await Ce({url:a,headers:l});if(u==="404: Not Found")return null;let d=e&&e!=="latest"?[JSON.parse(u)]:JSON.parse(u);return t&&console.log(`grabReleaseFromRepository for ${s}:`,d),(r=d.sort((f,w)=>{let b=rt(f.tag_name,{includePrerelease:!0,loose:!0}),E=rt(w.tag_name,{includePrerelease:!0,loose:!0});return wi(E,b)}).filter(f=>i||!f.prerelease)[0])!=null?r:null}catch(a){if(a instanceof N)throw a;return t&&console.log(`Error in grabReleaseFromRepository for ${s}:`,a),null}},Ce=async(s,e)=>{let i=0,t=0,n=0,o=Math.floor(Date.now()/1e3);try{return await(0,D.request)(s)}catch(r){let a=r,l=a.headers;if(l&&(i=Number.parseInt(l["x-ratelimit-limit"]),t=Number.parseInt(l["x-ratelimit-remaining"]),n=Number.parseInt(l["x-ratelimit-reset"])),a.status===403&&t===0){let u=new N(i,t,n,s.url);throw e&&console.error(`BRAT
GitHub API rate limit exceeded:`,`
Request: ${u.requestUrl}`,`
Rate limits - Remaining: ${u.remaining}`,`
Reset in: ${u.getMinutesToReset()} minutes`),u}throw a.status===404?new Error("404: Not Found"):a.status>=400?new Error(`GitHub API returned status ${a.status}`):(e&&console.log("GitHub request failed:",r),r)}};var $e={pluginList:[],pluginSubListFrozenVersion:[],themesList:[],updateAtStartup:!0,updateThemesAtStartup:!0,enableAfterInstall:!0,loggingEnabled:!1,loggingPath:"BRAT-log",loggingVerboseEnabled:!1,debuggingMode:!1,notificationsEnabled:!0,personalAccessToken:""};function dt(s,e,i="latest",t=""){let n=!1;s.settings.pluginList.contains(e)||(s.settings.pluginList.unshift(e),n=!0),s.settings.pluginSubListFrozenVersion.filter(o=>o.repo===e).length===0&&(s.settings.pluginSubListFrozenVersion.unshift({repo:e,version:i,token:t||void 0}),n=!0),n&&s.saveSettings()}function pt(s,e){return s.settings.pluginList.contains(e)}function mt(s,e,i){let t={repo:e,lastUpdate:z(i)};s.settings.themesList.unshift(t),s.saveSettings()}function ht(s,e){return!!s.settings.themesList.find(t=>t.repo===e)}function ft(s,e,i){for(let t of s.settings.themesList)t.repo===e&&(t.lastUpdate=i,s.saveSettings())}var $=require("obsidian");function Y(s,e){let i=new DocumentFragment,t=document.createElement("a");if(t.textContent=s,t.href=`https://github.com/${s}`,t.target="_blank",i.appendChild(t),e){let n=document.createTextNode(e);i.appendChild(n)}return i}var pe=require("obsidian");function m(s,e,i=10,t){if(!s.settings.notificationsEnabled)return;let n=t?pe.Platform.isDesktop?"(click=dismiss, right-click=Info)":"(click=dismiss)":"",o=new pe.Notice(`BRAT
${e}
${n}`,i*1e3);t&&(o.noticeEl.oncontextmenu=()=>{t()})}var V=(s,e=!0)=>{let i=s.createEl("div");i.style.float="right",e?(i.style.padding="15px",i.style.paddingLeft="15px",i.style.paddingRight="15px",i.style.marginLeft="15px"):(i.style.padding="10px",i.style.paddingLeft="15px",i.style.paddingRight="15px");let t=i.createDiv("coffee");t.addClass("ex-twitter-span"),t.style.paddingLeft="10px";let n=t.createDiv();n.innerText="Learn more about my work at:",t.appendChild(n);let o=t.createEl("a",{href:"https://tfthacker.com"});return o.innerText="https://tfthacker.com",i};var k=class extends $.Modal{constructor(i,t,n=!1,o=!1,r="",a="",l=""){super(i.app);this.versionSetting=null;this.addPluginButton=null;this.cancelButton=null;this.plugin=i,this.betaPlugins=t,this.address=r,this.version=a,this.privateApiKey=l,this.openSettingsTabAfterwards=n,this.trackFixedVersion=o,this.enableAfterInstall=i.settings.enableAfterInstall}async submitForm(){if(this.address==="")return;let i=this.address.replace("https://github.com/","");i.endsWith(".git")&&(i=i.slice(0,-4));let t=this.plugin.settings.pluginSubListFrozenVersion.find(o=>o.repo===i);if(t){t.version=this.version,t.token=this.privateApiKey||"",await this.plugin.saveSettings(),await this.betaPlugins.addPlugin(i,!1,!1,!1,this.version,!0,this.enableAfterInstall,this.privateApiKey)&&this.close();return}if(!this.version&&pt(this.plugin,i)){m(this.plugin,"This plugin is already in the list for beta testing",10);return}await this.betaPlugins.addPlugin(i,!1,!1,!1,this.version,!1,this.enableAfterInstall,this.privateApiKey)&&this.close()}updateVersionDropdown(i,t,n=""){i.clear(),i.addDropdown(o=>{o.addOption("","Select a version"),o.addOption("latest","Latest version");for(let r of t)o.addOption(r.version,`${r.version} ${r.prerelease?"(Prerelease)":""}`);o.setValue(n),o.onChange(r=>{this.version=r,this.addPluginButton&&(this.version!==""?this.addPluginButton.setDisabled(!1):this.addPluginButton.setDisabled(!0))}),o.selectEl.style.width="100%"})}onOpen(){let i=this.contentEl.createEl("h4");this.address?(i.appendText("Change plugin version: "),i.appendChild(Y(this.address))):i.setText("Github repository for beta plugin:"),this.contentEl.createEl("form",{},t=>{if(t.addClass("brat-modal"),!this.address||!this.trackFixedVersion){let r=new $.Setting(t).setClass("repository-setting"),a=r.settingEl.createDiv("validation-status");a.style.color="var(--text-error)",a.style.marginTop="6px",a.style.fontSize="0.8em",r.then(l=>{l.addText(u=>{u.setPlaceholder("Repository (example: https://github.com/GitubUserName/repository-name)"),u.setValue(this.address),u.onChange(d=>{var f,w;this.address=d.trim(),this.trackFixedVersion&&(!this.address||!this.isGitHubRepositoryMatch(this.address))&&this.versionSetting&&(this.updateVersionDropdown(this.versionSetting,[]),this.versionSetting.settingEl.classList.add("disabled-setting"),this.versionSetting.setDisabled(!0),u.inputEl.classList.remove("valid-repository"),u.inputEl.classList.remove("invalid-repository")),this.trackFixedVersion||(this.isGitHubRepositoryMatch(this.address)?(f=this.addPluginButton)==null||f.setDisabled(!1):(w=this.addPluginButton)==null||w.setDisabled(!0))}),u.inputEl.addEventListener("keydown",async d=>{var f,w,b;d.key==="Enter"&&(this.address&&(this.trackFixedVersion&&this.version!==""||!this.trackFixedVersion)&&(d.preventDefault(),(f=this.addPluginButton)==null||f.setDisabled(!0),(w=this.cancelButton)==null||w.setDisabled(!0),(b=this.versionSetting)==null||b.setDisabled(!0),this.submitForm()),await this.updateRepositoryVersionInfo(this.version,u))}),this.trackFixedVersion&&u.inputEl.addEventListener("blur",async()=>{await this.updateRepositoryVersionInfo(this.version,u,a)}),u.inputEl.style.width="100%"})})}this.trackFixedVersion&&(new $.Setting(t).setClass("api-setting").addText(r=>{r.setPlaceholder("GitHub API key for private repository (optional)").setValue(this.privateApiKey).onChange(async a=>{this.privateApiKey=a.trim(),this.address&&await this.updateRepositoryVersionInfo(this.version,r)}),r.inputEl.type="password",r.inputEl.style.width="100%"}),this.versionSetting=new $.Setting(t).setClass("version-setting").setClass("disabled-setting"),this.updateVersionDropdown(this.versionSetting,[],this.version),this.versionSetting.setDisabled(!0)),t.createDiv("modal-button-container",r=>{var a;r.createEl("label",{cls:"mod-checkbox"},l=>{let u=l.createEl("input",{attr:{tabindex:-1},type:"checkbox"});u.checked=this.enableAfterInstall,u.addEventListener("click",()=>{this.enableAfterInstall=u.checked}),l.appendText("Enable after installing the plugin")}),this.cancelButton=new $.ButtonComponent(r).setButtonText("Never mind").setClass("mod-cancel").onClick(l=>{this.close()}),this.addPluginButton=new $.ButtonComponent(r).setButtonText(this.trackFixedVersion&&this.address?"Change version":"Add plugin").setClass("mod-cta").onClick(l=>{var u,d,f,w;l.preventDefault(),this.address!==""&&(this.trackFixedVersion&&this.version!==""||!this.trackFixedVersion)&&((u=this.addPluginButton)==null||u.setDisabled(!0),(d=this.addPluginButton)==null||d.setButtonText("Installing \u2026"),(f=this.cancelButton)==null||f.setDisabled(!0),(w=this.versionSetting)==null||w.setDisabled(!0),this.submitForm())}),(this.trackFixedVersion||this.address==="")&&((a=this.addPluginButton)==null||a.setDisabled(!0))});let n=t.createDiv();n.style.borderTop="1px solid #ccc",n.style.marginTop="30px";let o=n.createSpan();o.innerHTML="BRAT by <a href='https://bit.ly/o42-twitter'>TFTHacker</a>",o.style.fontStyle="italic",n.appendChild(o),V(n,!1),window.setTimeout(()=>{let r=t.querySelectorAll(".brat-modal .setting-item-info");for(let a of Array.from(r))a.remove()},50),t.addEventListener("submit",r=>{var a;r.preventDefault(),this.address!==""&&(this.trackFixedVersion&&this.version!==""||!this.trackFixedVersion)&&((a=this.addPluginButton)==null||a.setDisabled(!0),this.submitForm())})}),this.address&&window.setTimeout(async()=>{await this.updateRepositoryVersionInfo(this.version)},100)}async updateRepositoryVersionInfo(i="",t,n){var r,a;if(this.plugin.settings.debuggingMode&&console.log(`[BRAT] Updating version dropdown for ${this.address} with selected version ${i}`),!this.address){n&&n.setText("Repository address is required.");return}this.versionSetting&&this.trackFixedVersion&&this.updateVersionDropdown(this.versionSetting,[],i);let o=this.address.replace("https://github.com/","");o.endsWith(".git")&&(o=o.slice(0,-4));try{let l=await at(o,this.plugin.settings.debuggingMode,this.privateApiKey||this.plugin.settings.personalAccessToken);l&&l.length>0?(t==null||t.inputEl.classList.remove("invalid-repository"),t==null||t.inputEl.classList.add("valid-repository"),this.versionSetting&&(this.versionSetting.settingEl.classList.remove("disabled-setting"),this.versionSetting.setDisabled(!1),this.updateVersionDropdown(this.versionSetting,l,i))):(t==null||t.inputEl.classList.remove("valid-repository"),t==null||t.inputEl.classList.add("invalid-repository"),this.versionSetting&&(this.versionSetting.settingEl.classList.add("disabled-setting"),this.versionSetting.setDisabled(!0),(r=this.addPluginButton)==null||r.setDisabled(!0)))}catch(l){l instanceof N&&(t==null||t.inputEl.classList.remove("valid-repository"),t==null||t.inputEl.classList.add("validation-error"),n==null||n.setText(`GitHub API rate limit exceeded. Try again in ${l.getMinutesToReset()} minutes.`),this.versionSetting&&(this.versionSetting.settingEl.classList.add("disabled-setting"),this.versionSetting.setDisabled(!0),(a=this.addPluginButton)==null||a.setDisabled(!0)),m(this.plugin,`${l.message} Consider adding a personal access token in BRAT settings for higher limits. See documentation for details.`,20,()=>{window.open("https://github.com/TfTHacker/obsidian42-brat/blob/main/BRAT-DEVELOPER-GUIDE.md#github-api-rate-limits")}))}}onClose(){this.openSettingsTabAfterwards&&(this.plugin.app.setting.open(),this.plugin.app.setting.openTabById(this.plugin.APP_ID))}isGitHubRepositoryMatch(i){let t=i.trim().replace(/\.git$/,"").toLowerCase();return/^(?:https:\/\/github\.com\/)?([a-zA-Z0-9._-]+)\/([a-zA-Z0-9._-]+)$/.test(t)}};var bt=require("obsidian");async function me(){try{let s=await(0,bt.requestUrl)(`https://obsidian.md/?${Math.random()}`);return s.status>=200&&s.status<300}catch(s){return!1}}var wt=Ie(),he=Le(),X=class{constructor(e){this.plugin=e}displayAddNewPluginModal(e=!1,i=!1,t="",n="",o=""){new k(this.plugin,this,e,i,t,n,o).open()}async validateRepository(e,i=!1,t=!1,n="",o=""){try{let a=await Ae(e,this.plugin.settings.debuggingMode,o||this.plugin.settings.personalAccessToken),l=await Se(e,n,i,this.plugin.settings.debuggingMode,a,o||this.plugin.settings.personalAccessToken);if(!l)return t&&(m(this.plugin,`${e}
This does not seem to be an obsidian plugin with valid releases, as there are no releases available.`,15),console.error("BRAT: validateRepository",e,i,t)),null;let u=await j(l,"manifest.json",this.plugin.settings.debuggingMode,a,o||this.plugin.settings.personalAccessToken);if(!u)return t&&(m(this.plugin,`${e}
This does not seem to be an obsidian plugin, as there is no manifest.json file.`,15),console.error("BRAT: validateRepository",e,i,t)),null;let d=JSON.parse(u);if(!("id"in d))return t&&m(this.plugin,`${e}
The plugin id attribute for the release is missing from the manifest file`,15),null;if(!("version"in d))return t&&m(this.plugin,`${e}
The version attribute for the release is missing from the manifest file`,15),null;let f=he(l.tag_name,{includePrerelease:!0,loose:!0}),w=he(d.version,{includePrerelease:!0,loose:!0});return wt(f,w)!==0&&(t&&m(this.plugin,`${e}
Version mismatch detected:
Release tag version: ${l.tag_name}
Manifest version: ${d.version}

The release tag version will be used to ensure consistency.`,15),d.version=f.version),d}catch(a){if(a instanceof N){let l=`GitHub API rate limit exceeded. Reset in ${a.getMinutesToReset()} minutes.`;throw t&&m(this.plugin,l,15),console.error(`BRAT: validateRepository ${a}`),m(this.plugin,`${a.message} Consider adding a personal access token in BRAT settings for higher limits. See documentation for details.`,20,()=>{window.open("https://github.com/TfTHacker/obsidian42-brat/blob/main/BRAT-DEVELOPER-GUIDE.md#github-api-rate-limits")}),a}return t&&m(this.plugin,`${e}
Unspecified error encountered: ${a}, verify debug for more information.`,15),null}}async getAllReleaseFiles(e,i,t,n="",o=""){let r=await Ae(e,this.plugin.settings.debuggingMode,o),a=await Se(e,n,t,this.plugin.settings.debuggingMode,r,o||this.plugin.settings.personalAccessToken);if(!a)return Promise.reject("No release found");let l=t||n!=="";return console.log({reallyGetManifestOrNot:l,version:a.tag_name}),{mainJs:await j(a,"main.js",this.plugin.settings.debuggingMode,r,o||this.plugin.settings.personalAccessToken),manifest:l?await j(a,"manifest.json",this.plugin.settings.debuggingMode,r,o||this.plugin.settings.personalAccessToken):"",styles:await j(a,"styles.css",this.plugin.settings.debuggingMode,r,o||this.plugin.settings.personalAccessToken)}}async writeReleaseFilesToPluginFolder(e,i){var o,r;let t=`${(0,F.normalizePath)(`${this.plugin.app.vault.configDir}/plugins/${e}`)}/`,{adapter:n}=this.plugin.app.vault;await n.exists(t)||await n.mkdir(t),await n.write(`${t}main.js`,(o=i.mainJs)!=null?o:""),await n.write(`${t}manifest.json`,(r=i.manifest)!=null?r:""),i.styles&&await n.write(`${t}styles.css`,i.styles)}async addPlugin(e,i=!1,t=!1,n=!1,o="",r=!1,a=this.plugin.settings.enableAfterInstall,l=""){this.plugin.settings.debuggingMode&&console.log("BRAT: addPlugin",e,i,t,n,o,r,a,l?"private":"public");let u=10,d=await this.validateRepository(e,!0,!0,o,l),f=!!d;if(f||(d=await this.validateRepository(e,!1,!0,o,l)),d===null){let b=`${e}
A manifest.json file does not exist in the latest release of the repository. This plugin cannot be installed.`;return await this.plugin.log(b,!0),m(this.plugin,b,u),!1}if(!Object.hasOwn(d,"version")){let b=`${e}
The manifest.json file in the latest release or pre-release of the repository does not have a version number in the file. This plugin cannot be installed.`;return await this.plugin.log(b,!0),m(this.plugin,b,u),!1}if(!Object.hasOwn(d,"minAppVersion")&&!(0,F.requireApiVersion)(d.minAppVersion)){let b=`Plugin: ${e}

The manifest.json for this plugin indicates that the Obsidian version of the app needs to be ${d.minAppVersion}, but this installation of Obsidian is ${F.apiVersion}. 

You will need to update your Obsidian to use this plugin or contact the plugin developer for more information.`;return await this.plugin.log(b,!0),m(this.plugin,b,30),!1}let w=async()=>{let b=await this.getAllReleaseFiles(e,d,f,o,l);if(console.log("rFiles",b),(f||b.manifest==="")&&(b.manifest=JSON.stringify(d)),this.plugin.settings.debuggingMode&&console.log("BRAT: rFiles.manifest",f,b),b.mainJs===null){let E=`${e}
The release is not complete and cannot be download. main.js is missing from the Release`;return await this.plugin.log(E,!0),m(this.plugin,E,u),null}return b};if(!i||r){let b=await w();if(b===null)return!1;if(await this.writeReleaseFilesToPluginFolder(d.id,b),r||dt(this.plugin,e,o,l),a){let{plugins:E}=this.plugin.app,y=(0,F.normalizePath)(`${E.getPluginFolder()}/${d.id}`);await E.loadManifest(y),await E.enablePluginAndSave(d.id)}if(await this.plugin.app.plugins.loadManifests(),r)await this.reloadPlugin(d.id),await this.plugin.log(`${e} reinstalled`,!0),m(this.plugin,`${e}
Plugin has been reinstalled and reloaded with version ${d.version}`,u);else{let E=o===""?"":` (version: ${o})`,y=`${e}${E}
The plugin has been registered with BRAT.`;a||(y+=" You may still need to enable it the Community Plugin List."),await this.plugin.log(y,!0),m(this.plugin,y,u)}}else{let b=`${this.plugin.app.vault.configDir}/plugins/${d.id}/`,E="";try{E=await this.plugin.app.vault.adapter.read(`${b}manifest.json`)}catch(A){if(A.errno===-4058||A.errno===-2)return await this.addPlugin(e,!1,f,!1,o,!1,a,l),!0;console.log("BRAT - Local Manifest Load",d.id,JSON.stringify(A,null,2))}if(o!==""&&o!=="latest")return m(this.plugin,`The version of ${e} is frozen, not updating.`,3),!1;let y=await JSON.parse(E),v=he(y.version,{includePrerelease:!0,loose:!0}),P=he(d.version,{includePrerelease:!0,loose:!0});if(wt(v,P)===-1){let A=await w();if(A===null)return!1;if(t){let Ue=`There is an update available for ${d.id} from version ${y.version} to ${d.version}. `;return await this.plugin.log(`${Ue}[Release Info](https://github.com/${e}/releases/tag/${d.version})`,!0),m(this.plugin,Ue,30,()=>{d&&window.open(`https://github.com/${e}/releases/tag/${d.version}`)}),!1}await this.writeReleaseFilesToPluginFolder(d.id,A),await this.plugin.app.plugins.loadManifests(),await this.reloadPlugin(d.id);let x=`${d.id}
Plugin has been updated from version ${y.version} to ${d.version}. `;return await this.plugin.log(`${x}[Release Info](https://github.com/${e}/releases/tag/${d.version})`,!0),m(this.plugin,x,30,()=>{d&&window.open(`https://github.com/${e}/releases/tag/${d.version}`)}),!0}return n&&m(this.plugin,`No update available for ${e}`,3),!0}return!0}async reloadPlugin(e){let{plugins:i}=this.plugin.app;try{await i.disablePlugin(e),await i.enablePlugin(e)}catch(t){this.plugin.settings.debuggingMode&&console.log("reload plugin",t)}}async updatePlugin(e,i=!1,t=!1,n=!1,o=""){let r=await this.addPlugin(e,!0,i,t,"",n,!1,o);return!r&&!i&&m(this.plugin,`${e}
Update of plugin failed.`),r}async checkForPluginUpdatesAndInstallUpdates(e=!1,i=!1){var a,l;if(!await me()){console.log("BRAT: No internet detected.");return}let t,n="Checking for plugin updates STARTED";await this.plugin.log(n,!0),e&&this.plugin.settings.notificationsEnabled&&(t=new F.Notice(`BRAT
${n}`,3e4));let o=new Map(this.plugin.settings.pluginSubListFrozenVersion.map(u=>[u.repo,{version:u.version,token:u.token}]));for(let u of this.plugin.settings.pluginList)o.has(u)&&((a=o.get(u))==null?void 0:a.version)!=="latest"||await this.updatePlugin(u,i,!1,!1,(l=o.get(u))==null?void 0:l.token);let r="Checking for plugin updates COMPLETED";await this.plugin.log(r,!0),e&&(t&&t.hide(),m(this.plugin,r,10))}deletePlugin(e){let i=`Removed ${e} from BRAT plugin list`;this.plugin.log(i,!0),this.plugin.settings.pluginList=this.plugin.settings.pluginList.filter(t=>t!==e),this.plugin.settings.pluginSubListFrozenVersion=this.plugin.settings.pluginSubListFrozenVersion.filter(t=>t.repo!==e),this.plugin.saveSettings()}getEnabledDisabledPlugins(e){let i=this.plugin.app.plugins,t=Object.values(i.manifests),n=Object.values(i.plugins).map(o=>o.manifest);return e?t.filter(o=>n.find(r=>o.id===r.id)):t.filter(o=>!n.find(r=>o.id===r.id))}};var M=require("obsidian");var W=async(s,e,i)=>{let t=await U(e,!0,s.settings.debuggingMode);if(t||(t=await U(e,!1,s.settings.debuggingMode)),!t)return m(s,"There is no theme.css or theme-beta.css file in the root path of this repository, so there is no theme to install."),!1;let n=await gt(e,s.settings.debuggingMode);if(!n)return m(s,"There is no manifest.json file in the root path of this repository, so theme cannot be installed."),!1;let o=await JSON.parse(n),r=(0,M.normalizePath)(Ti(s)+o.name),{adapter:a}=s.app.vault;await a.exists(r)||await a.mkdir(r),await a.write((0,M.normalizePath)(`${r}/theme.css`),t),await a.write((0,M.normalizePath)(`${r}/manifest.json`),n),ft(s,e,z(t));let l="";return i?(mt(s,e,t),l=`${o.name} theme installed from ${e}. `,setTimeout(()=>{s.app.customCss.setTheme(o.name)},500)):l=`${o.name} theme updated from ${e}.`,s.log(`${l}[Theme Info](https://github.com/${e})`,!1),m(s,l,20,()=>{window.open(`https://github.com/${e}`)}),!0},_=async(s,e)=>{if(!await me()){console.log("BRAT: No internet detected.");return}let i,t="Checking for beta theme updates STARTED";await s.log(t,!0),e&&s.settings.notificationsEnabled&&(i=new M.Notice(`BRAT
${t}`,3e4));for(let o of s.settings.themesList){let r=await q(o.repo,!0,s.settings.debuggingMode);r==="0"&&(r=await q(o.repo,!1,s.settings.debuggingMode)),console.log("BRAT: lastUpdateOnline",r),r!==o.lastUpdate&&await W(s,o.repo,!1)}let n="Checking for beta theme updates COMPLETED";(async()=>await s.log(n,!0))(),e&&(s.settings.notificationsEnabled&&i&&i.hide(),m(s,n))},fe=(s,e)=>{s.settings.themesList=s.settings.themesList.filter(t=>t.repo!==e),s.saveSettings();let i=`Removed ${e} from BRAT themes list and will no longer be updated. However, the theme files still exist in the vault. To remove them, go into Settings > Appearance and remove the theme.`;s.log(i,!0),m(s,i)},Ti=s=>`${(0,M.normalizePath)(`${s.app.vault.configDir}/themes`)}/`;var be=require("obsidian");var O=class extends be.Modal{constructor(e,i=!1){super(e.app),this.plugin=e,this.address="",this.openSettingsTabAfterwards=i}async submitForm(){if(this.address==="")return;let e=this.address.replace("https://github.com/","");if(ht(this.plugin,e)){m(this.plugin,"This theme is already in the list for beta testing",10);return}await W(this.plugin,e,!0)&&this.close()}onOpen(){this.contentEl.createEl("h4",{text:"Github repository for beta theme:"}),this.contentEl.createEl("form",{},e=>{e.addClass("brat-modal"),new be.Setting(e).addText(n=>{n.setPlaceholder("Repository (example: https://github.com/GitubUserName/repository-name"),n.setValue(this.address),n.onChange(o=>{this.address=o.trim()}),n.inputEl.addEventListener("keydown",o=>{o.key==="Enter"&&this.address!==" "&&(o.preventDefault(),this.submitForm())}),n.inputEl.style.width="100%",window.setTimeout(()=>{let o=document.querySelector(".setting-item-info");o&&o.remove(),n.inputEl.focus()},10)}),e.createDiv("modal-button-container",n=>{n.createEl("button",{attr:{type:"button"},text:"Never mind"}).addEventListener("click",()=>{this.close()}),n.createEl("button",{attr:{type:"submit"},cls:"mod-cta",text:"Add theme"})});let i=e.createDiv();i.style.borderTop="1px solid #ccc",i.style.marginTop="30px";let t=i.createSpan();t.innerHTML="BRAT by <a href='https://bit.ly/o42-twitter'>TFTHacker</a>",t.style.fontStyle="italic",i.appendChild(t),V(i,!1),window.setTimeout(()=>{let n=e.querySelectorAll(".brat-modal .setting-item-info");for(let o of Array.from(n))o.remove()},50),e.addEventListener("submit",n=>{n.preventDefault(),this.address!==""&&this.submitForm()})})}onClose(){this.openSettingsTabAfterwards&&(this.plugin.app.setting.openTab(),this.plugin.app.setting.openTabById(this.plugin.APP_ID))}};var Et=require("obsidian"),I=class extends Et.FuzzySuggestModal{constructor(i){super(i.app);this.data=[];this.scope.register(["Shift"],"Enter",t=>{this.enterTrigger(t)}),this.scope.register(["Ctrl"],"Enter",t=>{this.enterTrigger(t)})}setSuggesterData(i){this.data=i}display(i){this.callbackFunction=i,this.open()}getItems(){return this.data}getItemText(i){return i.display}onChooseItem(){}renderSuggestion(i,t){t.createEl("div",{text:i.item.display})}enterTrigger(i){var o;let t=(o=document.querySelector(".suggestion-item.is-selected div"))==null?void 0:o.textContent,n=this.data.find(r=>r.display===t);n&&(this.invokeCallback(n,i),this.close())}onChooseSuggestion(i,t){this.invokeCallback(i.item,t)}invokeCallback(i,t){typeof this.callbackFunction=="function"&&this.callbackFunction(i,t)}};var J=class{constructor(e){this.bratCommands=[{id:"AddBetaPlugin",icon:"BratIcon",name:"Plugins: Add a beta plugin for testing (with or without version)",showInRibbon:!0,callback:()=>{this.plugin.betaPlugins.displayAddNewPluginModal(!1,!0)}},{id:"checkForUpdatesAndUpdate",icon:"BratIcon",name:"Plugins: Check for updates to all beta plugins and UPDATE",showInRibbon:!0,callback:async()=>{await this.plugin.betaPlugins.checkForPluginUpdatesAndInstallUpdates(!0,!1)}},{id:"checkForUpdatesAndDontUpdate",icon:"BratIcon",name:"Plugins: Only check for updates to beta plugins, but don't Update",showInRibbon:!0,callback:async()=>{await this.plugin.betaPlugins.checkForPluginUpdatesAndInstallUpdates(!0,!0)}},{id:"updateOnePlugin",icon:"BratIcon",name:"Plugins: Choose a single plugin version to update",showInRibbon:!0,callback:()=>{let e=new Map(this.plugin.settings.pluginSubListFrozenVersion.map(n=>[n.repo,{version:n.version,token:n.token}])),i=Object.values(this.plugin.settings.pluginList).filter(n=>{let o=e.get(n);return!(o!=null&&o.version)||o.version==="latest"}).map(n=>{let o=e.get(n);return{display:n,info:n}}),t=new I(this.plugin);t.setSuggesterData(i),t.display(n=>{let o=`Checking for updates for ${n.info}`,r=e.get(n.info);this.plugin.log(o,!0),m(this.plugin,`
${o}`,3),this.plugin.betaPlugins.updatePlugin(n.info,!1,!0,!1,r==null?void 0:r.token)})}},{id:"reinstallOnePlugin",icon:"BratIcon",name:"Plugins: Choose a single plugin to reinstall",showInRibbon:!0,callback:()=>{let e=new Set(this.plugin.settings.pluginSubListFrozenVersion.map(n=>n.repo)),i=Object.values(this.plugin.settings.pluginList).filter(n=>!e.has(n)).map(n=>({display:n,info:n})),t=new I(this.plugin);t.setSuggesterData(i),t.display(n=>{let o=`Reinstalling ${n.info}`;m(this.plugin,`
${o}`,3),this.plugin.log(o,!0),this.plugin.betaPlugins.updatePlugin(n.info,!1,!1,!0)})}},{id:"restartPlugin",icon:"BratIcon",name:"Plugins: Restart a plugin that is already installed",showInRibbon:!0,callback:()=>{let e=Object.values(this.plugin.app.plugins.manifests).map(t=>({display:t.id,info:t.id})),i=new I(this.plugin);i.setSuggesterData(e),i.display(t=>{m(this.plugin,`${t.info}
Plugin reloading .....`,5),this.plugin.betaPlugins.reloadPlugin(t.info)})}},{id:"disablePlugin",icon:"BratIcon",name:"Plugins: Disable a plugin - toggle it off",showInRibbon:!0,callback:()=>{let e=this.plugin.betaPlugins.getEnabledDisabledPlugins(!0).map(t=>({display:`${t.name} (${t.id})`,info:t.id})),i=new I(this.plugin);i.setSuggesterData(e),i.display(t=>{this.plugin.log(`${t.display} plugin disabled`,!1),this.plugin.settings.debuggingMode&&console.log(t.info),this.plugin.app.plugins.disablePluginAndSave(t.info)})}},{id:"enablePlugin",icon:"BratIcon",name:"Plugins: Enable a plugin - toggle it on",showInRibbon:!0,callback:()=>{let e=this.plugin.betaPlugins.getEnabledDisabledPlugins(!1).map(t=>({display:`${t.name} (${t.id})`,info:t.id})),i=new I(this.plugin);i.setSuggesterData(e),i.display(t=>{this.plugin.log(`${t.display} plugin enabled`,!1),this.plugin.app.plugins.enablePluginAndSave(t.info)})}},{id:"openGitHubZRepository",icon:"BratIcon",name:"Plugins: Open the GitHub repository for a plugin",showInRibbon:!0,callback:async()=>{let e=await lt(this.plugin.settings.debuggingMode);if(e){let i=Object.values(e).map(o=>({display:`Plugin: ${o.name}  (${o.repo})`,info:o.repo})),t=Object.values(this.plugin.settings.pluginList).map(o=>({display:`BRAT: ${o}`,info:o}));for(let o of i)t.push(o);let n=new I(this.plugin);n.setSuggesterData(t),n.display(o=>{o.info&&window.open(`https://github.com/${o.info}`)})}}},{id:"openGitHubRepoTheme",icon:"BratIcon",name:"Themes: Open the GitHub repository for a theme (appearance)",showInRibbon:!0,callback:async()=>{let e=await ut(this.plugin.settings.debuggingMode);if(e){let i=Object.values(e).map(n=>({display:`Theme: ${n.name}  (${n.repo})`,info:n.repo})),t=new I(this.plugin);t.setSuggesterData(i),t.display(n=>{n.info&&window.open(`https://github.com/${n.info}`)})}}},{id:"opentPluginSettings",icon:"BratIcon",name:"Plugins: Open Plugin Settings Tab",showInRibbon:!0,callback:()=>{let e=this.plugin.app.setting,i=Object.values(e.pluginTabs).map(o=>({display:`Plugin: ${o.name}`,info:o.id})),t=new I(this.plugin),n=Object.values(e.settingTabs).map(o=>({display:`Core: ${o.name}`,info:o.id}));for(let o of i)n.push(o);t.setSuggesterData(n),t.display(o=>{e.open(),e.openTabById(o.info)})}},{id:"GrabBetaTheme",icon:"BratIcon",name:"Themes: Grab a beta theme for testing from a Github repository",showInRibbon:!0,callback:()=>{new O(this.plugin).open()}},{id:"updateBetaThemes",icon:"BratIcon",name:"Themes: Update beta themes",showInRibbon:!0,callback:async()=>{await _(this.plugin,!0)}},{id:"allCommands",icon:"BratIcon",name:"All Commands list",showInRibbon:!1,callback:()=>{this.ribbonDisplayCommands()}}];this.plugin=e;for(let i of this.bratCommands)this.plugin.addCommand({id:i.id,name:i.name,icon:i.icon,callback:()=>{i.callback()}})}ribbonDisplayCommands(){let e=[];for(let r of this.bratCommands)r.showInRibbon&&e.push({display:r.name,info:r.callback});let i=new I(this.plugin),t=this.plugin.app.setting,n=Object.values(t.settingTabs).map(r=>({display:`Core: ${r.name}`,info:()=>{t.open(),t.openTabById(r.id)}})),o=Object.values(t.pluginTabs).map(r=>({display:`Plugin: ${r.name}`,info:()=>{t.open(),t.openTabById(r.id)}}));e.push({display:"---- Core Plugin Settings ----",info:()=>{this.ribbonDisplayCommands()}});for(let r of n)e.push(r);e.push({display:"---- Plugin Settings ----",info:()=>{this.ribbonDisplayCommands()}});for(let r of o)e.push(r);i.setSuggesterData(e),i.display(r=>{typeof r.info=="function"&&r.info()})}};var R=require("obsidian");var we=class extends R.PluginSettingTab{constructor(e,i){super(e,i),this.plugin=i}display(){let{containerEl:e}=this;e.empty(),new R.Setting(e).setName("Auto-enable plugins after installation").setDesc('If enabled beta plugins will be automatically enabled after installtion by default. Note: you can toggle this on and off for each plugin in the "Add Plugin" form.').addToggle(t=>{t.setValue(this.plugin.settings.enableAfterInstall),t.onChange(async n=>{this.plugin.settings.enableAfterInstall=n,await this.plugin.saveSettings()})}),new R.Setting(e).setName("Auto-update plugins at startup").setDesc("If enabled all beta plugins will be checked for updates each time Obsidian starts. Note: this does not update frozen version plugins.").addToggle(t=>{t.setValue(this.plugin.settings.updateAtStartup),t.onChange(async n=>{this.plugin.settings.updateAtStartup=n,await this.plugin.saveSettings()})}),new R.Setting(e).setName("Auto-update themes at startup").setDesc("If enabled all beta themes will be checked for updates each time Obsidian starts.").addToggle(t=>{t.setValue(this.plugin.settings.updateThemesAtStartup),t.onChange(async n=>{this.plugin.settings.updateThemesAtStartup=n,await this.plugin.saveSettings()})}),V(e,!0),e.createEl("hr"),new R.Setting(e).setName("Beta plugin list").setHeading(),e.createEl("div",{text:'The following is a list of beta plugins added via the command "Add a beta plugin for testing". You can chose to add the latest version or a frozen version. A frozen version is a specific release of a plugin based on its release tag.'}),e.createEl("p"),e.createEl("div",{text:"Click the 'Edit' button next to a plugin to change the installed version and the x button next to a plugin to remove it from the list."}),e.createEl("p"),e.createEl("span").createEl("b",{text:"Note: "}),e.createSpan({text:"Removing from the list does not delete the plugin, this should be done from the Community Plugins tab in Settings."}),new R.Setting(e).addButton(t=>{t.setButtonText("Add beta plugin"),t.onClick(()=>{this.plugin.betaPlugins.displayAddNewPluginModal(!0,!0)})});let i=new Map(this.plugin.settings.pluginSubListFrozenVersion.map(t=>[t.repo,{version:t.version,token:t.token}]));for(let t of this.plugin.settings.pluginList){let n=i.get(t),o=new R.Setting(e).setName(Y(t)).setDesc(n!=null&&n.version?` Tracked version: ${n.version} ${n.version==="latest"?"":"(frozen)"}`:"");(!(n!=null&&n.version)||n.version==="latest")&&o.addButton(r=>{r.setIcon("sync").setTooltip("Check and update plugin").onClick(async()=>{let a=await this.plugin.betaPlugins.updatePlugin(t,!1,!0,!1,n==null?void 0:n.token)})}),o.addButton(r=>{r.setIcon("edit"),r.setTooltip("Change version"),r.onClick(()=>{this.plugin.betaPlugins.displayAddNewPluginModal(!0,!0,t,n==null?void 0:n.version,n==null?void 0:n.token),this.plugin.app.setting.updatePluginSection()})}).addButton(r=>{r.setIcon("cross"),r.setTooltip("Delete this beta plugin"),r.onClick(()=>{if(r.buttonEl.textContent==="")r.setButtonText("Click once more to confirm removal");else{let{buttonEl:a}=r,{parentElement:l}=a;l!=null&&l.parentElement&&(l.parentElement.remove(),this.plugin.betaPlugins.deletePlugin(t))}})})}new R.Setting(e).setName("Beta themes list").setHeading(),new R.Setting(e).addButton(t=>{t.setButtonText("Add beta theme"),t.onClick(()=>{this.plugin.app.setting.close(),new O(this.plugin).open()})});for(let t of this.plugin.settings.themesList)new R.Setting(e).setName(Y(t.repo)).addButton(n=>{n.setIcon("cross"),n.setTooltip("Delete this beta theme"),n.onClick(()=>{if(n.buttonEl.textContent==="")n.setButtonText("Click once more to confirm removal");else{let{buttonEl:o}=n,{parentElement:r}=o;r!=null&&r.parentElement&&(r.parentElement.remove(),fe(this.plugin,t.repo))}})});new R.Setting(e).setName("Monitoring").setHeading(),new R.Setting(e).setName("Enable notifications").setDesc("BRAT will provide popup notifications for its various activities. Turn this off means  no notifications from BRAT.").addToggle(t=>{t.setValue(this.plugin.settings.notificationsEnabled),t.onChange(async n=>{this.plugin.settings.notificationsEnabled=n,await this.plugin.saveSettings()})}),new R.Setting(e).setName("Enable logging").setDesc("Plugin updates will be logged to a file in the log file.").addToggle(t=>{t.setValue(this.plugin.settings.loggingEnabled),t.onChange(async n=>{this.plugin.settings.loggingEnabled=n,await this.plugin.saveSettings()})}),new R.Setting(this.containerEl).setName("BRAT log file location").setDesc("Logs will be saved to this file. Don't add .md to the file name.").addSearch(t=>{t.setPlaceholder("Example: BRAT-log").setValue(this.plugin.settings.loggingPath).onChange(async n=>{this.plugin.settings.loggingPath=n,await this.plugin.saveSettings()})}),new R.Setting(e).setName("Enable verbose logging").setDesc("Get a lot  more information in  the log.").addToggle(t=>{t.setValue(this.plugin.settings.loggingVerboseEnabled),t.onChange(async n=>{this.plugin.settings.loggingVerboseEnabled=n,await this.plugin.saveSettings()})}),new R.Setting(e).setName("Debugging mode").setDesc("Atomic Bomb level console logging. Can be used for troubleshoting and development.").addToggle(t=>{t.setValue(this.plugin.settings.debuggingMode),t.onChange(async n=>{this.plugin.settings.debuggingMode=n,await this.plugin.saveSettings()})}),new R.Setting(e).setName("Personal access token").setDesc("If you need to access private repositories, enter the personal access token here.").addText(t=>{var n;t.setPlaceholder("Enter your personal access token").setValue((n=this.plugin.settings.personalAccessToken)!=null?n:"").onChange(async o=>{this.plugin.settings.personalAccessToken=o,await this.plugin.saveSettings()})})}};var yt=require("obsidian");function Tt(){(0,yt.addIcon)("BratIcon",'<path fill="currentColor" stroke="currentColor"  d="M 41.667969 41.667969 C 41.667969 39.367188 39.800781 37.5 37.5 37.5 C 35.199219 37.5 33.332031 39.367188 33.332031 41.667969 C 33.332031 43.96875 35.199219 45.832031 37.5 45.832031 C 39.800781 45.832031 41.667969 43.96875 41.667969 41.667969 Z M 60.417969 58.582031 C 59.460938 58.023438 58.320312 57.867188 57.25 58.148438 C 56.179688 58.429688 55.265625 59.125 54.707031 60.082031 C 53.746094 61.777344 51.949219 62.820312 50 62.820312 C 48.050781 62.820312 46.253906 61.777344 45.292969 60.082031 C 44.734375 59.125 43.820312 58.429688 42.75 58.148438 C 41.679688 57.867188 40.539062 58.023438 39.582031 58.582031 C 37.597656 59.726562 36.910156 62.257812 38.042969 64.25 C 40.5 68.53125 45.0625 71.171875 50 71.171875 C 54.9375 71.171875 59.5 68.53125 61.957031 64.25 C 63.089844 62.257812 62.402344 59.726562 60.417969 58.582031 Z M 62.5 37.5 C 60.199219 37.5 58.332031 39.367188 58.332031 41.667969 C 58.332031 43.96875 60.199219 45.832031 62.5 45.832031 C 64.800781 45.832031 66.667969 43.96875 66.667969 41.667969 C 66.667969 39.367188 64.800781 37.5 62.5 37.5 Z M 50 8.332031 C 26.988281 8.332031 8.332031 26.988281 8.332031 50 C 8.332031 73.011719 26.988281 91.667969 50 91.667969 C 73.011719 91.667969 91.667969 73.011719 91.667969 50 C 91.667969 26.988281 73.011719 8.332031 50 8.332031 Z M 50 83.332031 C 33.988281 83.402344 20.191406 72.078125 17.136719 56.363281 C 14.078125 40.644531 22.628906 24.976562 37.5 19.042969 C 37.457031 19.636719 37.457031 20.238281 37.5 20.832031 C 37.5 27.738281 43.097656 33.332031 50 33.332031 C 52.300781 33.332031 54.167969 31.46875 54.167969 29.167969 C 54.167969 26.867188 52.300781 25 50 25 C 47.699219 25 45.832031 23.132812 45.832031 20.832031 C 45.832031 18.53125 47.699219 16.667969 50 16.667969 C 68.410156 16.667969 83.332031 31.589844 83.332031 50 C 83.332031 68.410156 68.410156 83.332031 50 83.332031 Z M 50 83.332031 " />')}var Q=class{constructor(e){this.console=(e,...i)=>{console.log(`BRAT: ${e}`,...i)};this.themes={themeseCheckAndUpates:async e=>{await _(this.plugin,e)},themeInstallTheme:async e=>{let i=e.replace("https://github.com/","");await W(this.plugin,i,!0)},themesDelete:e=>{let i=e.replace("https://github.com/","");fe(this.plugin,i)},grabCommmunityThemeCssFile:async(e,i=!1)=>await U(e,i,this.plugin.settings.debuggingMode),grabChecksumOfThemeCssFile:async(e,i=!1)=>await q(e,i,this.plugin.settings.debuggingMode),grabLastCommitDateForFile:async(e,i)=>await ct(e,i)};this.plugin=e}};var oe=require("obsidian"),Mt=zt(kt());async function xt(s,e,i=!1){if(s.settings.debuggingMode&&console.log(`BRAT: ${e}`),s.settings.loggingEnabled){if(!s.settings.loggingVerboseEnabled&&i)return;let t=`${s.settings.loggingPath}.md`,n=`[[${(0,oe.moment)().format((0,Mt.getDailyNoteSettings)().format).toString()}]] ${(0,oe.moment)().format("HH:mm")}`,o=window.require("os"),r=oe.Platform.isDesktop?o.hostname():"MOBILE",a=`${n} ${r} ${e.replace(`
`," ")}
`,l=s.app.vault.getAbstractFileByPath(t);l?await s.app.vault.append(l,a):l=await s.app.vault.create(t,a)}}var Ee=class extends Bt.Plugin{constructor(){super(...arguments);this.APP_NAME="BRAT";this.APP_ID="obsidian42-brat";this.settings=$e;this.betaPlugins=new X(this);this.commands=new J(this);this.bratApi=new Q(this);this.obsidianProtocolHandler=i=>{if(!i.plugin&&!i.theme){m(this,"Could not locate the repository from the URL.",10);return}for(let t of["plugin","theme"])if(i[t]){let n=t==="plugin"?new k(this,this.betaPlugins):new O(this);n.address=i[t],n.open();return}}}onload(){console.log(`loading ${this.APP_NAME}`),Tt(),this.addRibbonIcon("BratIcon","BRAT",()=>{this.commands.ribbonDisplayCommands()}),this.loadSettings().then(()=>{this.app.workspace.onLayoutReady(()=>{this.addSettingTab(new we(this.app,this)),this.registerObsidianProtocolHandler("brat",this.obsidianProtocolHandler),this.settings.updateAtStartup&&setTimeout(()=>{this.betaPlugins.checkForPluginUpdatesAndInstallUpdates(!1)},6e4),this.settings.updateThemesAtStartup&&setTimeout(()=>{_(this,!1)},12e4),setTimeout(()=>{window.bratAPI=this.bratApi},500)})}).catch(i=>{console.error("Failed to load settings:",i)})}async log(i,t=!1){await xt(this,i,t)}onunload(){console.log(`unloading ${this.APP_NAME}`)}async loadSettings(){this.settings=Object.assign({},$e,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}};

/* nosourcemap */